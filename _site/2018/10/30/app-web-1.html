<h1 id="aplicações-na-web---parte-i">Aplicações na Web - Parte I</h1>

<p>(Actividade da ExpoFCT 2018)
<a href="https://cienciavivadifct.bitbucket.io/">https://cienciavivadifct.bitbucket.io/</a></p>

<p>Esta actividade destina-se a demonstrar como é possível fazer uma pequena aplicação Web, ilustrando a criação de uma página web que nos deixa consultar os dados disponíveis na Internet e organizá-los da forma mais conveniente. A informação que vamos disponibilizar na nossa página é aquela proveniente do site <a href="http://www.omdbapi.com/">Open Movie Database</a></p>

<h2 id="passo-1-criar-uma-página-web-vazia">Passo 1: Criar uma página web vazia</h2>

<p>Em primeiro lugar vamos criar uma página web muito simples, apenas contendo a estrutura que pretendemos. Para isso, vamos editar um ficheiro no nosso computador, utilizando um editor de texto simples.</p>

<p>Podemos utilizar um ficheiro de texto contendo código escrito numa linguagem chamada HTML. Podemos utilizar para isso qualquer editor de texto disponível no computador. Grave o seu ficheiro no ambiente de trabalho com o nome <code class="highlighter-rouge">naWeb.html</code>. Nesse ficheiro pode colocar o seguinte código:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;DOCTYPE</span> <span class="na">html</span><span class="nt">&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;title&gt;</span>Aplicações na Web - ExpoFCT 2018<span class="nt">&lt;/title&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>

	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>Esta página está vazia mas já contém a estrutura básica que precisaremos para a página. O código HTML é composto por etiquetas que definem uma estrutura hierárquica para os vários elementos da página. As etiquetas têm um nome (ex: <code class="highlighter-rouge">html</code>), um elemento HTML a abrir (ex: <code class="highlighter-rouge">&lt;head&gt;</code>), e outro a fechar (ex: <code class="highlighter-rouge">&lt;/head&gt;</code>). No exemplo acima, temos um elemento da página <code class="highlighter-rouge">&lt;head&gt;</code>, que define um conjunto de informações importantes da página tal como o seu título, o aspecto geral da página e o seu comportamento. Temos também o elemento <code class="highlighter-rouge">&lt;body&gt;</code> da página onde se definem os elementos visíveis da página.</p>

<h2 id="passo-2-criar-a-estrutura-interna-da-página-web">Passo 2: Criar a estrutura interna da página web</h2>

<p>As páginas web que conhecemos dividem-se em divisórias, que em HTML são representadas pela etiqueta <code class="highlighter-rouge">&lt;div&gt;</code>, e que podem conter outras divisórias ou elementos HTML, como imagens ou elementos de <code class="highlighter-rouge">input</code> (caixas de texto ou botões). Para além disso, cada elemento HTML pode ainda ser enriquecido de outra forma através de atributos que de forma convencionada alteram o seu aspecto ou comportamento. Copie o código abaixo para dentro da etiqueta <code class="highlighter-rouge">&lt;body&gt;</code> da sua página:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>
	  <span class="nt">&lt;div&gt;</span>
	    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"http://ctp.di.fct.unl.pt/~jcs/expofct15/naWeb/images/logo_fctunl.png"</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;/div&gt;</span>

	  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"nav"</span><span class="nt">&gt;</span>
	    <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"search"</span> <span class="na">type=</span><span class="s">text</span> <span class="na">size=</span><span class="s">40</span><span class="nt">&gt;</span>
	    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">id=</span><span class="s">"searchButton"</span> <span class="na">class=</span><span class="s">"btn-primary"</span> <span class="na">value=</span><span class="s">"Search"</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;/div&gt;</span>
	  <span class="nt">&lt;h1&gt;</span>Search the web for movie posters<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  (mais à frente vamos colocar mais código aqui)
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>Se abrir a sua página num browser, deve obter um resultado semelhante a:</p>

<p><img src="http://ctp.di.fct.unl.pt/~jcs/expofct15/naWeb/images/first.png" alt="Primeira fase" />{height=4cm}\</p>

<p>Podem observar-se várias zonas e elementos nesta página, identifique quer na página, quer no código, a imagem, a caixa de texto para introduzir o texto de pesquisa, o botão que despoleta a pesquisa e o título. Repare que alguns elementos têm os atributos <code class="highlighter-rouge">class</code>, <code class="highlighter-rouge">src</code>, <code class="highlighter-rouge">id</code>, <code class="highlighter-rouge">type</code>, ou <code class="highlighter-rouge">value</code> com valores específicos. É da articulação de uma série de elementos, atributos, e código noutras linguagens que é feita uma página Web.</p>

<h2 id="passo-3-criar-uma-montra-para-os-posters-de-filmes">Passo 3: Criar uma montra para os posters de filmes</h2>

<p>Para colocar os nossos posters na página precisamos de criar mais divisórias. Copie para o código da sua página, no local onde se lê <code class="highlighter-rouge">(resto do código aqui)</code>, o seguinte código:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"myCarousel"</span> <span class="na">class=</span><span class="s">"carousel slide"</span> <span class="na">data-ride=</span><span class="s">"carousel"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"posters"</span> <span class="na">class=</span><span class="s">"carousel-inner"</span> <span class="na">role=</span><span class="s">"listbox"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"item active"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"http://ctp.di.fct.unl.pt/~jcs/expofct15/naWeb/images/1.jpg"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
      	<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"http://ctp.di.fct.unl.pt/~jcs/expofct15/naWeb/images/2.jpg"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"left carousel-control"</span> <span class="na">href=</span><span class="s">"#myCarousel"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">data-slide=</span><span class="s">"prev"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"glyphicon glyphicon-chevron-left"</span> <span class="na">aria-hidden=</span><span class="s">"true"</span><span class="nt">&gt;&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"sr-only"</span><span class="nt">&gt;</span>Previous<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"right carousel-control"</span> <span class="na">href=</span><span class="s">"#myCarousel"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">data-slide=</span><span class="s">"next"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"glyphicon glyphicon-chevron-right"</span> <span class="na">aria-hidden=</span><span class="s">"true"</span><span class="nt">&gt;&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"sr-only"</span><span class="nt">&gt;</span>Next<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<h2 id="passo-4-mudar-o-aspecto-dos-elementos-existentes">Passo 4: Mudar o aspecto dos elementos existentes</h2>

<p>O aspecto dos elementos HTML de uma página é regido por um conjunto de regras de estilo, que vamos passar a escrever. Para obtermos resultados mais rapidamente, podemos fazer uso de uma biblioteca de regras de estilos que nos ajudará. Insira na zona de cabeçalho da pagina <code class="highlighter-rouge">&lt;head&gt;</code> as seguintes linhas de código:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<p>Através dos nomes dos elementos e dos seus atributos é possível especificar que regras se aplicam a que elementos e como é que se estes se formatam. Para perceber um pouco melhor copie estas regras para a sua página, para o fim da secção <code class="highlighter-rouge">&lt;head&gt;</code>.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;style&gt;</span>
<span class="nc">.container</span> <span class="p">{</span>
  <span class="nl">background</span><span class="p">:</span> <span class="sx">url(http://ctp.di.fct.unl.pt/~jcs/expofct15/naWeb/images/logo-expofct2012.png)</span>
  <span class="n">background</span><span class="p">:</span> <span class="nb">right</span> <span class="m">-60px</span> <span class="nb">no-repeat</span><span class="p">;</span>
<span class="p">}</span>
<span class="nf">#myCarousel</span> <span class="p">{</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="n">darkgrey</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.item</span> <span class="p">{</span>
  <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">500px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.item</span> <span class="o">&gt;</span> <span class="nt">img</span> <span class="p">{</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="nb">auto</span><span class="p">;</span>
  <span class="nl">min-height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.nav</span> <span class="p">{</span>
  <span class="nl">float</span><span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="m">20</span> <span class="m">0</span> <span class="m">10</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre></div></div>

<p>O aspecto da página deve ter mudado drasticamente depois destas duas modificações, certo? Deve ter algo como:</p>

<p><img src="http://ctp.di.fct.unl.pt/~jcs/expofct15/naWeb/images/second.png" alt="Segunda fase" />{height=6cm}\</p>

<p>Com estas últimas regras foi possível modificar o aspecto de vários elementos, em tamanho, côr, posição no ecrã, e até adicionar novos elementos, como o logo da ExpoFCT.</p>

<p>Experimente agora usar as duas setas que aparecem no ecrã. Já têm algum comportamento (mágico) associado. Esse comportamento está pré-programado no código que incorporámos na página por via do elemento <code class="highlighter-rouge">&lt;script&gt;</code> acima. Já se carregar no botão <code class="highlighter-rouge">Search</code>, não terá qualquer resposta, pois não? Pois, é que não há magia, temos que agora resolver essa parte do puzzle.</p>

<h2 id="passo-4-adicionar-comportamento-à-página">Passo 4: Adicionar comportamento à página.</h2>

<p>Para que a nossa página possa agora ter um comportamento mais rico, vamos adicionar uma ligação ao serviço <a href="http://www.omdbapi.com/">OMDb</a> que é disponibilizado na Internet. Para tal podemos adicionar o seguinte código no cabeçalho da página (fim da secção <code class="highlighter-rouge">&lt;head&gt;</code>).</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>

<span class="kd">function</span> <span class="nx">search</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
      <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
      <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">cache</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">crossDomain</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">jsonp</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="s2">"http://www.omdbapi.com/?apikey=YOUR-API-KEY-HERE"</span><span class="o">+</span><span class="s2">"&amp;t="</span><span class="o">+</span><span class="nx">$</span><span class="p">(</span><span class="s2">"#search"</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
      <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">data</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">Poster</span> <span class="o">!=</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">$</span><span class="p">(</span><span class="s2">".item.active"</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">"active"</span><span class="p">);</span>
          <span class="nx">$</span><span class="p">(</span><span class="s2">"#posters"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">"&lt;div&gt;"</span><span class="p">,{</span><span class="na">class</span><span class="p">:</span><span class="s2">"item active"</span><span class="p">}).</span><span class="nx">append</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">"&lt;img&gt;"</span><span class="p">,{</span><span class="na">src</span><span class="p">:</span><span class="nx">data</span><span class="p">.</span><span class="nx">Poster</span><span class="p">})));</span>
          <span class="nx">alert</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">"#search"</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="o">+</span> <span class="s2">" adicionado!"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">alert</span><span class="p">(</span><span class="s2">"Não conheço nenhum filme chamado "</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#search"</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="o">+</span> <span class="s2">"!"</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">},</span>
    <span class="p">});</span>
  <span class="p">}</span>

<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>Este código define a maneira de consultar o serviço remoto (<code class="highlighter-rouge">function search()</code>) fazendo uso dos elementos do ecrã <code class="highlighter-rouge">$(".item.active")</code> e <code class="highlighter-rouge">$("#posters")</code> e alterando a sua estrutura (função <code class="highlighter-rouge">append</code>). Também define que o botão com o identificador <code class="highlighter-rouge">#searchButton</code> vai usar a função search em caso de ser activado através da linha de código, adiciona-o depois da definição da função <code class="highlighter-rouge">search</code>:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#searchButton"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">search</span><span class="p">);</span> <span class="p">});</span>
</code></pre></div></div>
<p>Usamos o comando <code class="highlighter-rouge">if</code> para, caso não tenhamos recebido uma resposta (<code class="highlighter-rouge">data != null</code>) e o poster não exista (<code class="highlighter-rouge">data.Poster != undefined</code>), adicionar o poster ao carrousel e abrir uma janela de alerta atraves do:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">alert</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">"#search"</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="o">+</span> <span class="s2">" adicionado!"</span><span class="p">);</span>
</code></pre></div></div>

<p>Caso não exista um poster com esse titulo, é executado tudo o que está dentro do <code class="highlighter-rouge">else</code>, ou seja a mensagem de erro:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">alert</span><span class="p">(</span><span class="s2">"Não conheço nenhum filme chamado "</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#search"</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="o">+</span> <span class="s2">"!"</span><span class="p">);</span>
</code></pre></div></div>

<p>Para se poder utilizar o serviço <a href="http://www.omdbapi.com/">OMDb</a> é necessário uma chave que identifique a origem dos pedidos feitos ao serviço. O pedido da chave pode ser feito <a href="http://www.omdbapi.com/apikey.aspx">aqui</a>, bastanto para isso selecionar o tipo de conta <strong>FREE</strong>, inserir o seu email, primeiro e último nome e finalmente uma breve descrição sobre a aplicação web que vai utilizar o serviço <a href="http://www.omdbapi.com/">OMDb</a>.</p>

<p>Uma vez obtida a chave, deve substituir no código a parte que diz <code class="highlighter-rouge">YOUR-API-KEY-HERE</code> pela chave que recebeu (pode usar a chave d348ff6a).</p>

<p>Agora sim, deve conseguir experimentar a página web para pesquisar filmes na internet e coleccionar alguns posters. É claro que esta construção é só a ponta de um iceberg gigantesco, mas é certamente um dos blocos que ajuda a construir a Internet tal como a conhecemos.</p>

